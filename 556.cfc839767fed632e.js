"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[556],{4155:(tt,g,r)=>{r.r(g),r.d(g,{FormPagesModule:()=>m});var O=r(9132),t=r(4650),h=r(433),u=r(6895),N=r(4968),F=r(8372);const C=new t.OlP("NU_MONACO_EDITOR_CONFIG");let v,_=!1,z=(()=>{class i{constructor(o,e,a,s){this.el=o,this.doc=a,this.ngZone=s,this._resize$=null,this.height="200px",this.delay=0,this.event=new t.vpe,this._config={baseUrl:"https://cdn.jsdelivr.net/npm/monaco-editor/min",...e},this.options=this._config.defaultOptions}set disabled(o){this._disabled="string"==typeof o||o,this.setDisabled()}set options(o){this._options={...this._config.defaultOptions,...o}}get options(){return this._options}notifyEvent(o,e){this.ngZone.run(()=>this.event.emit({type:o,editor:this._editor,...e}))}setDisabled(){return this._editor&&this._editor.updateOptions({readOnly:this._disabled}),this}init(){_?v.then(()=>this.initMonaco(this.options,!0)):(_=!0,v=new Promise((o,e)=>{const a=window;if(null==a)return void o();if(a.monaco)return void o();const s=this._config.baseUrl,l=()=>{a.require.config({paths:{vs:`${s}/vs`}}),"function"==typeof this._config.monacoPreLoad&&this._config.monacoPreLoad(),a.require(["vs/editor/editor.main"],()=>{"function"==typeof this._config.monacoLoad&&this._config.monacoLoad(a.monaco),this.initMonaco(this.options,!0),o()},()=>{e("Unable to load editor/editor.main module, please check your network environment.")})};if(a.require)l();else{const d=this.doc.createElement("script");d.type="text/javascript",d.src=`${s}/vs/loader.js`,d.onload=l,d.onerror=()=>e(`Unable to load ${d.src}, please check your network environment.`),this.doc.getElementsByTagName("head")[0].appendChild(d)}}).catch(o=>this.notifyEvent("load-error",{error:o})))}cleanResize(){return this._resize$&&this._resize$.unsubscribe(),this}registerResize(){return this.cleanResize(),this._resize$=(0,N.R)(window,"resize").pipe((0,F.b)(100)).subscribe(()=>{this._editor.layout(),this.notifyEvent("resize")}),this}updateOptions(){!this._editor||this.ngZone.runOutsideAngular(()=>{this._editor.dispose(),this.initMonaco(this._options,!1)})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>setTimeout(()=>this.init(),+this.delay))}ngOnChanges(o){const e=Object.keys(o);1===e.length&&"disabled"===e[0]||this.updateOptions()}ngOnDestroy(){this.cleanResize(),this._editor&&(this._editor.dispose(),this._editor=void 0)}}return i.\u0275fac=function(o){return new(o||i)(t.Y36(t.SBq),t.Y36(C),t.Y36(u.K0),t.Y36(t.R0b))},i.\u0275cmp=t.Xpm({type:i,selectors:[["nu-monaco-base"]],inputs:{height:"height",delay:"delay",disabled:"disabled",options:"options"},outputs:{event:"event"},standalone:!0,features:[t.TTD,t.jDz],decls:0,vars:0,template:function(o,e){},encapsulation:2}),i})(),M=(()=>{class i extends z{constructor(){super(...arguments),this._value="",this.autoFormat=!0,this.onChange=o=>{},this.onTouched=()=>{}}get editor(){return this._editor}initMonaco(o,e){const a=!!this.model;if(a){const l=monaco.editor.getModel(this.model.uri||"");if(l)o.model=l,o.model.setValue(this._value);else{const{value:d,language:p,uri:q}=this.model;o.model=monaco.editor.createModel(d||this._value,p,q)}}null!=this._disabled&&(o.readOnly=this._disabled);const s=this._editor=monaco.editor.create(this.el.nativeElement,o);a||s.setValue(this._value),s.onDidChangeModelContent(()=>{const l=s.getValue();this.ngZone.run(()=>{this._value=l,this.onChange(l)})}),s.onDidBlurEditorWidget(()=>this.onTouched()),this.registerResize(),this.autoFormat?s.getAction("editor.action.formatDocument").run().then(()=>this.notifyEvent(e?"init":"re-init")):this.notifyEvent(e?"init":"re-init")}writeValue(o){this._value=o||"",this._editor&&this._editor.setValue(this._value)}registerOnChange(o){this.onChange=o}registerOnTouched(o){this.onTouched=o}setDisabledState(o){this.disabled=o,this.setDisabled()}}return i.\u0275fac=function(){let n;return function(e){return(n||(n=t.n5z(i)))(e||i)}}(),i.\u0275cmp=t.Xpm({type:i,selectors:[["nu-monaco-editor"]],hostVars:4,hostBindings:function(o,e){2&o&&t.Udp("display","block")("height",e.height)},inputs:{model:"model",autoFormat:"autoFormat"},exportAs:["nuMonacoEditor"],standalone:!0,features:[t._Bn([{provide:h.JU,useExisting:(0,t.Gpc)(()=>i),multi:!0}]),t.qOj,t.jDz],decls:0,vars:0,template:function(o,e){},encapsulation:2,changeDetection:0}),i})();const S=[M,(()=>{class i extends z{get editor(){return this._editor}initMonaco(o,e){if(!this.old||!this.new)throw new Error("old or new not found for nu-monaco-diff-editor");const a=o.theme;null!=this._disabled&&(o.readOnly=this._disabled);const s=this._editor=monaco.editor.createDiffEditor(this.el.nativeElement,o);o.theme=a,s.setModel({original:monaco.editor.createModel(this.old.code,this.old.language||o.language),modified:monaco.editor.createModel(this.new.code,this.new.language||o.language)}),s.onDidUpdateDiff(()=>this.notifyEvent("update-diff",{diffValue:s.getModifiedEditor().getValue()})),this.registerResize(),e&&this.notifyEvent("init")}}return i.\u0275fac=function(){let n;return function(e){return(n||(n=t.n5z(i)))(e||i)}}(),i.\u0275cmp=t.Xpm({type:i,selectors:[["nu-monaco-diff-editor"]],hostVars:4,hostBindings:function(o,e){2&o&&t.Udp("display","block")("height",e.height)},inputs:{old:"old",new:"new"},exportAs:["nuMonacoDiffEditor"],standalone:!0,features:[t.qOj,t.jDz],decls:0,vars:0,template:function(o,e){},encapsulation:2,changeDetection:0}),i})()];let V=(()=>{class i{static forRoot(o){return{ngModule:i,providers:[{provide:C,useValue:o}]}}}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[u.ez,S]}),i})();var J=r(7465),Z=r(2557),x=r(7579),A=r(2722),y=r(2025),B=r(9444),Q=r(9074),U=r(1807),$=r(9651),G=r(4927),T=r(6616),L=r(7044),R=r(1811),E=r(3679),j=r(7570),b=r(8231),w=r(1102),D=r(7830),f=r(8521),Y=r(4490);const I=["schemaEditor"],H=["formCodeEditor"],P=["uiEditor"];function k(i,n){if(1&i&&t._UZ(0,"nz-option",24),2&i){const o=n.$implicit;t.Q6J("nzValue",o.name)("nzLabel",o.title)}}function K(i,n){if(1&i){const o=t.EpF();t.TgZ(0,"div",1)(1,"sf",25),t.NdJ("formSubmit",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.submit(a))})("formChange",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.change(a))})("formValueChange",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.valueChange(a))})("formError",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.error(a))}),t.qZA()()}if(2&i){const o=t.oxw();t.Q6J("nzSpan",o.expand?12:24),t.xp6(1),t.Q6J("schema",o.schemaData)("formData",o.formData)("ui",o.uiSchema)("layout",o.layout)}}class c{constructor(n,o,e,a,s,l){this.i18n=n,this.codeSrv=o,this.http=e,this.msg=a,this.appService=s,this.cdr=l,this.destroy$=new x.x,this.files=[{name:"basic",title:"\u57fa\u672c"},{name:"conditional",title:"\u6761\u4ef6"},{name:"sort",title:"\u987a\u5e8f"},{name:"validation",title:"\u81ea\u5b9a\u4e49\u6821\u9a8c"},{name:"fixed",title:"\u4e0d\u89c4\u5219\u5e03\u5c40"}],this.layout="horizontal",this.expand=!0,this.editorOptions={language:"json",theme:"vs"},this.name=this.files[0].name,this.title=this.files[0].title,this.appService.theme$.pipe((0,A.R)(this.destroy$)).subscribe(p=>{this.editorOptions={language:"json",theme:"dark"===p?"vs-dark":"vs"}})}ngOnInit(){this.getSchema()}refreshLayout(n){setTimeout(()=>{this[n].editor.layout()},100)}getSchema(){const n=this.files.find(o=>o.name===this.name);if(n){if(this.name=n.name,this.title=n.title,n.cache)return this.schema=n.cache,void this.run();this.http.get(`./assets/schema/${n.name}.json`,null,{responseType:"text"}).subscribe(o=>{n.cache=o,this.schema=n.cache,this.run()})}}run(){this.schemaData=JSON.parse(this.schema||"{}"),this.formData=JSON.parse(this.formCode||"{}"),this.uiSchema=JSON.parse(this.uiCode||"{}"),this.cdr.detectChanges()}openOnStackBlitz(){const n={schema:this.schema,layout:this.layout,formData:this.formCode||"{}",ui:this.uiCode||"{}"},o="\nimport { Component } from '@angular/core';\nimport { SFSchema } from '@delon/form';\nimport { NzMessageService } from 'ng-zorro-antd/message';\n\n@Component({\n  selector: 'demo',\n  template: `\n  <sf [schema]=\"schema\" [formData]=\"formData\" [ui]=\"ui\" [layout]=\"layout\"\n      (formSubmit)=\"submit($event)\"\n      (formChange)=\"change($event)\"\n      (formError)=\"error($event)\"></sf>\n    `\n})\nexport class DemoComponent {\n  schema = {schema};\n  formData = {formData};\n  ui = {ui};\n  layout = '{layout}';\n\n  constructor(private msg: NzMessageService) { }\n\n  submit(value: any) {\n    this.msg.success(JSON.stringify(value));\n  }\n\n  change(value: any) {\n    console.log('formChange', value);\n  }\n\n  error(value: any) {\n    console.log('formError', value);\n  }\n}".replace(/\{(\w+)\}/g,(e,a)=>(n[a]||"").trim());this.codeSrv.openOnStackBlitz("sf-validator",o)}onCopy(){(0,B.JG)(this.schema).then(()=>this.msg.success(this.i18n.fanyi("app.demo.copied")))}submit(n){this.msg.success(JSON.stringify(n))}change(n){console.log("formChange",n)}valueChange(n){console.log("formChange",n)}error(n){console.log("formError",n)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}c.\u0275fac=function(n){return new(n||c)(t.Y36(y.Oi),t.Y36(Q.$),t.Y36(y.lP),t.Y36($.dD),t.Y36(U.z),t.Y36(t.sBO))},c.\u0275cmp=t.Xpm({type:c,selectors:[["form-validator"]],viewQuery:function(n,o){if(1&n&&(t.Gf(I,5),t.Gf(H,5),t.Gf(P,5)),2&n){let e;t.iGM(e=t.CRH())&&(o.schemaEditor=e.first),t.iGM(e=t.CRH())&&(o.formCodeEditor=e.first),t.iGM(e=t.CRH())&&(o.uiEditor=e.first)}},decls:34,vars:23,consts:[["nz-row","",1,"border-bottom-1","pb-sm","mb-md"],["nz-col","",3,"nzSpan"],[3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"ml-sm",3,"ngModel","ngModelChange"],["nz-radio-button","","nzValue","horizontal"],["nz-radio-button","","nzValue","vertical"],["nz-radio-button","","nzValue","inline"],["nz-col","",1,"text-right",3,"nzSpan"],["nz-tooltip","","nz-button","",3,"nzTooltipTitle","click"],["nz-icon","",3,"nzType"],["nz-tooltip","","nz-button","",1,"ml-sm",3,"nzTooltipTitle","click"],["nz-icon","","nzType","form"],["nz-icon","","nzType","copy"],["nz-row","",1,"border-bottom-1","pb-sm","mb-md",3,"nzGutter"],["nz-col","",3,"nzSpan","hidden"],["nzTitle","Schema",3,"nzClick"],["height","500px",3,"ngModel","options","ngModelChange"],["schemaEditor",""],["nzTitle","Form Data",3,"nzClick"],["formCodeEditor",""],["nzTitle","UI Schema",3,"nzClick"],["uiEditor",""],["nz-col","",3,"nzSpan",4,"ngIf"],[3,"nzValue","nzLabel"],[3,"schema","formData","ui","layout","formSubmit","formChange","formValueChange","formError"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"nz-select",2),t.NdJ("ngModelChange",function(a){return o.name=a})("ngModelChange",function(){return o.getSchema()}),t.YNc(3,k,1,2,"nz-option",3),t.qZA(),t.TgZ(4,"nz-radio-group",4),t.NdJ("ngModelChange",function(a){return o.layout=a}),t.TgZ(5,"label",5),t._uU(6,"\u6c34\u5e73"),t.qZA(),t.TgZ(7,"label",6),t._uU(8,"\u5782\u76f4"),t.qZA(),t.TgZ(9,"label",7),t._uU(10,"\u884c\u5185"),t.qZA()()(),t.TgZ(11,"div",8)(12,"nz-button-group")(13,"button",9),t.NdJ("click",function(){return o.expand=!o.expand}),t._UZ(14,"i",10),t.qZA(),t.TgZ(15,"button",11),t.NdJ("click",function(){return o.openOnStackBlitz()}),t.ALo(16,"i18n"),t._UZ(17,"i",12),t.qZA(),t.TgZ(18,"button",11),t.NdJ("click",function(){return o.onCopy()}),t.ALo(19,"i18n"),t._UZ(20,"i",13),t.qZA()()()(),t.TgZ(21,"div",14)(22,"div",15)(23,"nz-tabset")(24,"nz-tab",16),t.NdJ("nzClick",function(){return o.refreshLayout("schemaEditor")}),t.TgZ(25,"nu-monaco-editor",17,18),t.NdJ("ngModelChange",function(a){return o.schema=a})("ngModelChange",function(){return o.run()}),t.qZA()(),t.TgZ(27,"nz-tab",19),t.NdJ("nzClick",function(){return o.refreshLayout("formCodeEditor")}),t.TgZ(28,"nu-monaco-editor",17,20),t.NdJ("ngModelChange",function(a){return o.formCode=a})("ngModelChange",function(){return o.run()}),t.qZA()(),t.TgZ(30,"nz-tab",21),t.NdJ("nzClick",function(){return o.refreshLayout("uiEditor")}),t.TgZ(31,"nu-monaco-editor",17,22),t.NdJ("ngModelChange",function(a){return o.uiCode=a})("ngModelChange",function(){return o.run()}),t.qZA()()()(),t.YNc(33,K,2,5,"div",23),t.qZA()),2&n&&(t.xp6(1),t.Q6J("nzSpan",18),t.xp6(1),t.Q6J("ngModel",o.name),t.xp6(1),t.Q6J("ngForOf",o.files),t.xp6(1),t.Q6J("ngModel",o.layout),t.xp6(7),t.Q6J("nzSpan",6),t.xp6(2),t.Q6J("nzTooltipTitle",o.expand?"Hide Code":"Show Code"),t.xp6(1),t.MGl("nzType","vertical-",o.expand?"right":"left",""),t.xp6(1),t.Q6J("nzTooltipTitle",t.lcZ(16,19,"app.demo.stackblitz")),t.xp6(3),t.Q6J("nzTooltipTitle",t.lcZ(19,21,"app.demo.copy")),t.xp6(3),t.Q6J("nzGutter",24),t.xp6(1),t.Q6J("nzSpan",12)("hidden",!o.expand),t.xp6(3),t.Q6J("ngModel",o.schema)("options",o.editorOptions),t.xp6(3),t.Q6J("ngModel",o.formCode)("options",o.editorOptions),t.xp6(3),t.Q6J("ngModel",o.uiCode)("options",o.editorOptions),t.xp6(2),t.Q6J("ngIf",o.schemaData))},dependencies:[u.sg,u.O5,h.JJ,h.On,G.k,T.ix,T.fY,L.w,R.dQ,E.t3,E.SK,j.SY,b.Ip,b.Vq,w.Ls,D.xH,D.xw,f.Of,f.Bq,f.Dg,M,Y.C],encapsulation:2,changeDetection:0});const W=[{path:"",component:J.S,children:[{path:"validator/:lang",component:c,data:{titleI18n:"app.header.menu.form.validator"}}]}];class m{}m.\u0275fac=function(n){return new(n||m)},m.\u0275mod=t.oAB({type:m}),m.\u0275inj=t.cJS({imports:[Z.m,V.forRoot({defaultOptions:{scrollBeyondLastLine:!1}}),O.Bz.forChild(W)]})}}]);