import{a as A,b as Q}from"./chunk-LANDAJ75.js";import{$a as $,C as g,H as a,Ja as O,Ka as n,L as y,La as x,Ma as j,Na as S,Oa as E,Qb as I,Rb as N,Ta as d,Tb as D,Wg as T,a as m,ab as z,ca as v,cd as L,da as _,dd as M,de as f,fa as c,ga as w,ha as b,hb as l,ia as C,jd as P,k as p,q as u,uc as k}from"./chunk-KLO4GQEX.js";var q=(()=>{let t=class t{get cog(){return this._cog}set cog(i){this._cog=this.cogSrv.merge("chart",{theme:"",echartsLib:"https://cdnjs.cloudflare.com/ajax/libs/echarts/5.1.0/echarts.min.js"},i)}constructor(i,o){this.cogSrv=i,this.lazySrv=o,this.loading=!1,this.loaded=!1,this.notify$=new p,this.cog={theme:""}}libLoad(){return this.loading?(this.loaded&&this.notify$.next(),this):(this.loading=!0,this.lazySrv.load(this.cog.echartsLib).then(()=>{let i=this.cog.echartsExtensions;return Array.isArray(i)&&i.length>0?this.lazySrv.load(i).then(()=>!0):Promise.resolve(!0)}).then(()=>{this.loaded=!0,this.notify$.next()}),this)}get notify(){return this.notify$.asObservable()}ngOnDestroy(){this.notify$.unsubscribe()}};t.\u0275fac=function(o){return new(o||t)(c(M),c(L))},t.\u0275prov=v({token:t,factory:t.\u0275fac,providedIn:"root"});let s=t;return s})();var F=["container"];function R(s,t){s&1&&l(0,"nz-skeleton")}var r=class r{set width(t){this._width=typeof t=="number"?`${t}px`:`${t}`}set height(t){this._height=typeof t=="number"?`${t}px`:`${t}`}set theme(t){this._theme=t,this._chart&&this.install()}set initOpt(t){this._initOpt=t,this._chart&&this.install()}set option(t){this._option=t,this._chart&&this.setOption(t,!0)}get chart(){return this._chart}constructor(t,e,i,o){this.srv=t,this.cdr=e,this.ngZone=i,this.platform=o,this.destroy$=w(j),this._chart=null,this._width="100%",this._height="400px",this.on=[],this.events=new S,this.loaded=!1,this.srv.notify.pipe(f(),a(()=>!this.loaded)).subscribe(()=>this.load()),this.theme=t.cog.echartsTheme}emit(t,e){this.events.emit(m({type:t,chart:this.chart},e))}load(){this.ngZone.run(()=>{this.loaded=!0,this.cdr.detectChanges()}),this.emit("ready"),this.install()}install(){this.destroy();let t=this._chart=window.echarts.init(this.node.nativeElement,this._theme,this._initOpt);return this.emit("init"),this.setOption(this._option),this.on.forEach(e=>{e.query!=null?t.on(e.eventName,e.query,i=>e.handler({event:i,chart:t})):t.on(e.eventName,i=>e.handler({event:i,chart:t}))}),this}destroy(){return this._chart&&(this._chart.dispose(),this.emit("destroy")),this}setOption(t,e=!1,i=!1){return this._chart&&(this._chart.setOption(t,e,i),this.emit("set-option",{option:t})),this}ngOnInit(){this.platform.isBrowser&&(window.echarts?this.load():this.srv.libLoad(),g(window,"resize").pipe(f(this.destroy$),a(()=>!!this._chart),y(200)).subscribe(()=>this._chart.resize()))}ngOnDestroy(){this.on.forEach(t=>this._chart?.off(t.eventName)),this.destroy()}};r.\u0275fac=function(e){return new(e||r)(n(q),n(x),n(E),n(P))},r.\u0275cmp=b({type:r,selectors:[["chart-echarts"],["","chart-echarts",""]],viewQuery:function(e,i){if(e&1&&N(F,7),e&2){let o;I(o=D())&&(i.node=o.first)}},hostVars:6,hostBindings:function(e,i){e&2&&d("display","inline-block")("width",i._width)("height",i._height)},inputs:{width:"width",height:"height",theme:"theme",initOpt:"initOpt",option:"option",on:"on"},outputs:{events:"events"},exportAs:["chartECharts"],decls:3,vars:5,consts:[["container",""]],template:function(e,i){e&1&&($(0,R,1,0,"nz-skeleton"),l(1,"div",null,0)),e&2&&(z(0,i.loaded?-1:0),O(1),d("width",i._width)("height",i._height))},dependencies:[A],encapsulation:2,changeDetection:0});var h=r;u([T()],h.prototype,"load",null);var ft=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=C({type:t}),t.\u0275inj=_({imports:[k,Q]});let s=t;return s})();export{h as a,ft as b};
