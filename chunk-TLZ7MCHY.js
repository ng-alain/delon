import{d as wt,f as Mt,h as _t,i as Ce}from"./chunk-AJZURQR5.js";import{a as St,b as Nt}from"./chunk-2SZKEF6B.js";import{a as zt,f as Ct,l as vt,u as bt}from"./chunk-7BM3L5ZS.js";import{$a as U,$e as rt,Aa as Pe,Ac as X,Ba as Oe,Bb as q,Bc as tt,Db as A,Dc as nt,Ea as Be,Eg as dt,Fb as b,Gb as fe,H as oe,Hb as pe,Hc as Z,Hg as mt,Ia as ke,Ig as ut,La as v,Ld as H,M as Ee,Mb as qe,Na as Fe,Nb as G,Nd as J,Ob as W,Oc as it,Oe as at,Pb as ze,Qa as he,Qb as Ge,Rb as K,Sb as Ke,U as Ie,Ub as D,Va as T,Vb as Q,W as ye,Wa as ge,Wb as Qe,Wc as ot,Wd as st,_a as Le,aa as De,ba as Re,ca as de,ch as ht,fa as _,fb as y,gb as Ve,hc as Xe,ic as Ze,k as le,ka as L,kb as E,l as we,la as V,m as ne,ma as me,mb as I,oa as Te,pb as $e,ph as gt,q as Me,qa as ue,qb as Ue,r as ce,ra as xe,rb as M,sb as S,sc as Je,t as _e,tb as N,ua as R,ub as O,vb as We,wa as $,wb as He,wc as B,wg as se,wh as ft,x as ie,xb as Y,xg as ee,xh as pt,yb as je,yc as et,yg as lt,za as Ae,zb as Ye,zc as f,zg as ct}from"./chunk-HYQTCAQ6.js";var Ft=["content"],Lt=["nz-segmented-item",""],It=["*"];function Vt(r,m){}function $t(r,m){if(r&1&&(S(0,"span"),U(1,Vt,0,0,"ng-template",3),N()),r&2){b(2);let e=ze(5);v(),M("ngTemplateOutlet",e)}}function Ut(r,m){if(r&1&&(S(0,"span",4),O(1,"nz-icon",5),N(),E(2,$t,2,1,"span")),r&2){let e=b();v(),M("nzType",m),v(),I(e.hasLabel()?2:-1)}}function Wt(r,m){}function Ht(r,m){if(r&1&&U(0,Wt,0,0,"ng-template",3),r&2){b();let e=ze(5);M("ngTemplateOutlet",e)}}function jt(r,m){r&1&&pe(0)}var Yt=(r,m)=>m.value;function qt(r,m){if(r&1){let e=q();S(0,"div",2),Ve(function(){L(e);let n=b();return V(n.thumbAnimationEnter())}),A("transitionend",function(n){L(e);let l=b();return V(l.handleTransitionEnd(n))}),N()}if(r&2){let e=b();Ke(e.thumbStyle())}}function Gt(r,m){if(r&1&&(S(0,"label",3),D(1),N()),r&2){let e=m.$implicit;M("nzIcon",e.icon)("nzValue",e.value)("nzDisabled",e.disabled),v(),Qe(" ",e.label," ")}}function Kt(r,m){if(r&1&&$e(0,Gt,2,4,"label",3,Yt),r&2){let e=b();Ue(e.normalizedOptions)}}var ve=(()=>{class r{defaultName=_(rt).getId("segmented_");name=R(this.defaultName);selected$=new ne(1);activated$=new ne(1);change$=new le;disabled$=new ne(1);animating$=new we(!1);keydown$=new le;_animating=J(this.animating$,{initialValue:!1});animationEnabled=ft(()=>!0);showThumb=B(()=>this.animationEnabled()&&this._animating());constructor(){_(ue).onDestroy(()=>{this.selected$.complete(),this.activated$.complete(),this.change$.complete(),this.disabled$.complete(),this.animating$.complete(),this.keydown$.complete()})}setName(e){this.name.set(typeof e>"u"?this.defaultName:e)}static \u0275fac=function(s){return new(s||r)};static \u0275prov=Re({token:r,factory:r.\u0275fac})}return r})(),te=(()=>{class r{service=_(ve);elementRef=_(Oe);destroyRef=_(ue);templateRef=X.required("content",{read:he});nzValue=f.required();nzIcon=f();nzDisabled=f(!1,{transform:Z});hasLabel=B(()=>this.templateRef().createEmbeddedView({}).rootNodes.some(e=>e.textContent.trim().length>0));showThumb=this.service.showThumb;name=this.service.name.asReadonly();isChecked=R(!1);parentDisabled=J(this.service.disabled$,{initialValue:!1});finalDisabled=B(()=>this.nzDisabled()||this.parentDisabled());ngOnInit(){this.service.selected$.pipe(ye(e=>{this.isChecked.set(!1),e===this.nzValue()&&this.service.activated$.next(this.elementRef.nativeElement)}),Ie(e=>this.service.animationEnabled()?this.service.animating$.pipe(oe(s=>!s),Ee(1),ie(()=>e)):_e(e)),oe(e=>e===this.nzValue()),H(this.destroyRef)).subscribe(()=>this.isChecked.set(!0))}handleClick(){!this.nzDisabled()&&!this.parentDisabled()&&(this.service.selected$.next(this.nzValue()),this.service.change$.next(this.nzValue()))}handleKeydown(e){this.finalDisabled()||(e.keyCode===37||e.keyCode===39||e.keyCode===38||e.keyCode===40)&&this.service.keydown$.next(e)}static \u0275fac=function(s){return new(s||r)};static \u0275cmp=T({type:r,selectors:[["label","nz-segmented-item",""],["label","nzSegmentedItem",""]],viewQuery:function(s,n){s&1&&G(n.templateRef,Ft,5,he),s&2&&W()},hostAttrs:[1,"ant-segmented-item"],hostVars:4,hostBindings:function(s,n){s&1&&A("click",function(){return n.handleClick()})("keydown",function(a){return n.handleKeydown(a)}),s&2&&K("ant-segmented-item-selected",!n.showThumb()&&n.isChecked())("ant-segmented-item-disabled",n.finalDisabled())},inputs:{nzValue:[1,"nzValue"],nzIcon:[1,"nzIcon"],nzDisabled:[1,"nzDisabled"]},exportAs:["nzSegmentedItem"],attrs:Lt,ngContentSelectors:It,decls:6,vars:5,consts:[["content",""],["type","radio",1,"ant-segmented-item-input",3,"click","disabled","checked"],[1,"ant-segmented-item-label"],[3,"ngTemplateOutlet"],[1,"ant-segmented-item-icon"],[3,"nzType"]],template:function(s,n){if(s&1){let l=q();fe(),S(0,"input",1),A("click",function(h){return L(l),V(h.stopPropagation())}),N(),S(1,"div",2),E(2,Ut,3,2)(3,Ht,1,1,null,3),N(),U(4,jt,1,0,"ng-template",null,0,Je)}if(s&2){let l;M("disabled",n.finalDisabled())("checked",n.isChecked()),y("name",n.name()),v(),y("aria-selected",n.isChecked()),v(),I((l=n.nzIcon())?2:3,l)}},dependencies:[ee,se,it],encapsulation:2,changeDetection:0})}return r})();function Qt(r){return r.map(m=>typeof m=="string"||typeof m=="number"?{label:`${m}`,value:m}:m)}var Xt="segmented",yt=(()=>{let r,m=[],e=[];return class ae{static{let n=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;r=[at()],Me(null,null,r,{kind:"field",name:"nzSize",static:!1,private:!1,access:{has:l=>"nzSize"in l,get:l=>l.nzSize,set:(l,a)=>{l.nzSize=a}},metadata:n},m,e),n&&Object.defineProperty(this,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:n})}_nzModuleName=Xt;service=_(ve);injector=_(Te);dir=_(st).valueSignal;nzBlock=!1;nzDisabled=!1;nzOptions=[];nzVertical=!1;nzShape="default";nzSize=ce(this,m,"default");nzName=ce(this,e);nzValueChange=new xe;viewItemCmps=tt(te);contentItemCmps=nt(te);renderedItemCmps=B(()=>this.viewItemCmps().concat(this.contentItemCmps()));isDisabledFirstChange=!0;value;thumbStyle=R(null);thumbAnimationEnter=pt(()=>"ant-segmented-thumb-motion-appear-active");showThumb=this.service.showThumb;normalizedOptions=[];onChange=()=>{};onTouched=()=>{};constructor(){this.service.selected$.pipe(H()).subscribe(n=>{this.value=n}),this.service.activated$.pipe(H()).subscribe(n=>{this.thumbStyle.update(l=>{let a=this.calcThumbStyle(n);if(l&&a)gt(()=>{this.thumbStyle.set(this.getThumbStyle(a))});else if(a)return this.getThumbStyle(a);return l})}),this.service.change$.pipe(H()).subscribe(n=>{this.nzValueChange.emit(n),this.onChange(n),this.service.animating$.next(!0)}),this.service.keydown$.pipe(oe(()=>!this.nzDisabled),H()).subscribe(n=>this.onKeyDown(n)),Fe(()=>{$(()=>{let n=this.renderedItemCmps();n.length&&(this.value===void 0||!n.some(l=>l.nzValue()===this.value))&&this.service.selected$.next(n[0].nzValue())},{injector:this.injector})})}ngOnChanges(n){let{nzName:l,nzOptions:a,nzDisabled:h}=n;l&&this.service.setName(this.nzName),a&&(this.normalizedOptions=Qt(a.currentValue)),h&&this.service.disabled$.next(h.currentValue)}onOffset(n){let l=this.renderedItemCmps(),a=l.length,h=l.findIndex(o=>o.nzValue()===this.value),t=(h+n+a)%a;for(;l[t].nzDisabled()&&(t=(t+Math.sign(n)+a)%a,t!==h););let i=l[t];i&&(this.service.selected$.next(i.nzValue()),this.service.change$.next(i.nzValue()))}onKeyDown(n){switch(n.keyCode){case 38:this.onOffset(-1);break;case 37:this.onOffset(this.dir()==="rtl"?1:-1);break;case 40:this.onOffset(1);break;case 39:this.onOffset(this.dir()==="rtl"?-1:1);break}}writeValue(n){this.service.selected$.next(n)}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}setDisabledState(n){this.nzDisabled=this.isDisabledFirstChange&&this.nzDisabled||n,this.isDisabledFirstChange=!1}calcThumbStyle(n){if(!n||!n.offsetParent)return null;let l=n.parentElement;if(!l)return null;let a={left:n.offsetLeft,right:l.clientWidth-n.clientWidth-n.offsetLeft,width:n.clientWidth,top:n.offsetTop,bottom:l.clientHeight-n.clientHeight-n.offsetTop,height:n.clientHeight};return this.nzVertical?{left:0,right:0,width:0,top:a.top,bottom:a.bottom,height:a.height}:{left:a.left,right:a.right,width:a.width,top:0,bottom:0,height:0}}getThumbStyle(n){return this.nzVertical?{transform:`translateY(${n.top}px)`,width:"100%",height:`${n.height}px`}:{transform:`translateX(${this.dir()==="rtl"?-n.right:n.left}px)`,width:`${n.width}px`,height:"100%"}}handleTransitionEnd(n){n.propertyName==="transform"&&this.service.animating$.next(!1)}static \u0275fac=function(l){return new(l||ae)};static \u0275cmp=T({type:ae,selectors:[["nz-segmented"]],contentQueries:function(l,a,h){l&1&&qe(h,a.contentItemCmps,te,4),l&2&&W()},viewQuery:function(l,a){l&1&&G(a.viewItemCmps,te,5),l&2&&W()},hostAttrs:["role","radiogroup","aria-label","segmented control",1,"ant-segmented"],hostVars:15,hostBindings:function(l,a){l&2&&(y("tabindex",a.nzDisabled?void 0:0),K("ant-segmented-disabled",a.nzDisabled)("ant-segmented-rtl",a.dir()==="rtl")("ant-segmented-lg",a.nzSize==="large")("ant-segmented-sm",a.nzSize==="small")("ant-segmented-block",a.nzBlock)("ant-segmented-vertical",a.nzVertical)("ant-segmented-shape-round",a.nzShape==="round"))},inputs:{nzBlock:[2,"nzBlock","nzBlock",Z],nzDisabled:[2,"nzDisabled","nzDisabled",Z],nzOptions:"nzOptions",nzVertical:[2,"nzVertical","nzVertical",Z],nzShape:"nzShape",nzSize:"nzSize",nzName:"nzName"},outputs:{nzValueChange:"nzValueChange"},exportAs:["nzSegmented"],features:[Xe([ve,{provide:zt,useExisting:De(()=>ae),multi:!0}]),Ae],ngContentSelectors:It,decls:4,vars:1,consts:[[1,"ant-segmented-group"],[1,"ant-segmented-thumb",3,"style"],[1,"ant-segmented-thumb",3,"transitionend"],["nz-segmented-item","",3,"nzIcon","nzValue","nzDisabled"]],template:function(l,a){l&1&&(fe(),S(0,"div",0),E(1,qt,1,2,"div",1),pe(2,0,null,Kt,2,0),N()),l&2&&(v(),I(a.showThumb()?1:-1))},dependencies:[ee,ct,te],encapsulation:2,changeDetection:0})}})();var j=class r extends _t{static KEY="segmented";_list;get list(){return this._list??[]}reset(m){wt(this.schema,this.ui,m).subscribe(e=>{this._list=e,this.detectChanges()})}valueChange(m){let e=this.list;this.ui.valueChange?.({index:m,item:typeof m=="number"?e[m]:e.find(s=>s.value===m)})}static \u0275fac=(()=>{let m;return function(s){return(m||(m=Pe(r)))(s||r)}})();static \u0275cmp=T({type:r,selectors:[["sf-segmented"]],features:[Le],decls:4,vars:11,consts:[[3,"id","schema","ui","showError","error","showTitle"],[3,"ngModelChange","nzValueChange","ngModel","nzDisabled","nzSize","nzBlock","nzOptions"]],template:function(e,s){e&1&&(S(0,"sf-item-wrap",0),D(1,`
    `),S(2,"nz-segmented",1),A("ngModelChange",function(l){return s.setValue(l)})("nzValueChange",function(l){return s.valueChange(l)}),N(),D(3,`
  `),N()),e&2&&(M("id",s.id)("schema",s.schema)("ui",s.ui)("showError",s.showError)("error",s.error)("showTitle",s.schema.title),v(2),M("ngModel",s.value)("nzDisabled",s.disabled)("nzSize",s.ui.size)("nzBlock",s.ui.block??!1)("nzOptions",s.list))},dependencies:[bt,Ct,vt,Ce,Mt,yt],encapsulation:2})};function li(){return{KEY:j.KEY,type:j}}var Zt=["canvas"],Jt=["image"];function en(r,m){if(r&1&&Y(0,"img",3,1),r&2){let e=b();y("src",e.icon(),ke)}}function tn(r,m){if(r&1&&(me(),Y(0,"image",2)),r&2){let e,s,n,l,a,h=b();y("href",(e=h.imageSettings())==null?null:e.src)("height",(s=h.calculatedImageSettings())==null?null:s.h)("width",(n=h.calculatedImageSettings())==null?null:n.w)("x",h.getImageX())("y",h.getImageY())("opacity",(l=h.calculatedImageSettings())==null?null:l.opacity)("crossOrigin",(a=h.calculatedImageSettings())==null?null:a.crossOrigin)}}var nn=()=>({x:0,y:0,h:0,w:0,excavation:null,opacity:1,crossOrigin:""});function on(r,m){if(r&1&&(je(0),D(1),Ye()),r&2){let e=b(2);v(),Q(e.nzStatusRender())}}function sn(r,m){if(r&1&&(S(0,"div",0),U(1,on,2,1,"ng-container",1),N()),r&2){let e=b();v(),M("nzStringTemplateOutlet",e.nzStatusRender())}}function an(r,m){r&1&&O(0,"nz-spin")}function rn(r,m){if(r&1){let e=q();S(0,"div")(1,"p",2),D(2),N(),S(3,"button",3),A("click",function(){L(e);let n=b(2);return V(n.reloadQRCode())}),O(4,"nz-icon",4),S(5,"span"),D(6),N()()()}if(r&2){let e=b(2);v(2),Q(e.locale().expired),v(4),Q(e.locale().refresh)}}function ln(r,m){if(r&1&&(S(0,"div")(1,"p",2),D(2),N()()),r&2){let e=b(2);v(2),Q(e.locale().scanned)}}function cn(r,m){if(r&1&&(S(0,"div",0),E(1,an,1,0,"nz-spin")(2,rn,7,2,"div")(3,ln,3,1,"div"),N()),r&2){let e,s=b();v(),I((e=s.nzStatus())==="loading"?1:e==="expired"?2:e==="scanned"?3:-1)}}function dn(r,m){if(r&1&&O(0,"nz-qrcode-canvas",5),r&2){let e=b(2);M("icon",e.nzIcon())("margin",e.margin())("cells",e.cells())("numCells",e.numCells())("calculatedImageSettings",e.calculatedImageSettings())("size",e.nzSize())("color",e.nzColor())("bgColor",e.nzBgColor())}}function mn(r,m){if(r&1&&O(0,"nz-qrcode-svg",6),r&2){let e=b(2);M("color",e.nzColor())("bgColor",e.nzBgColor())("icon",e.nzIcon())("margin",e.margin())("cells",e.cells())("numCells",e.numCells())("imageSettings",e.imageSettings())("calculatedImageSettings",e.calculatedImageSettings()||Ze(9,nn))("size",e.nzSize())}}function un(r,m){if(r&1&&E(0,dn,1,8,"nz-qrcode-canvas",5)(1,mn,1,10,"nz-qrcode-svg",6),r&2){let e,s=b();I((e=s.nzType())==="canvas"?0:e==="svg"?1:-1)}}var k;(function(r){let m=(()=>{class a{version;errorCorrectionLevel;static encodeText(t,i){let o=r.QrSegment.makeSegments(t);return a.encodeSegments(o,i)}static encodeBinary(t,i){let o=r.QrSegment.makeBytes(t);return a.encodeSegments([o],i)}static encodeSegments(t,i,o=1,c=40,d=-1,g=!0){if(!(a.MIN_VERSION<=o&&o<=c&&c<=a.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");let u,z;for(u=o;;u++){let C=a.getNumDataCodewords(u,i)*8,w=l.getTotalBits(t,u);if(w<=C){z=w;break}if(u>=c)throw new RangeError("Data too long")}for(let C of[a.Ecc.MEDIUM,a.Ecc.QUARTILE,a.Ecc.HIGH])g&&z<=a.getNumDataCodewords(u,C)*8&&(i=C);let p=[];for(let C of t){e(C.mode.modeBits,4,p),e(C.numChars,C.mode.numCharCountBits(u),p);for(let w of C.getData())p.push(w)}n(p.length==z);let P=a.getNumDataCodewords(u,i)*8;n(p.length<=P),e(0,Math.min(4,P-p.length),p),e(0,(8-p.length%8)%8,p),n(p.length%8==0);for(let C=236;p.length<P;C^=253)e(C,8,p);let x=[];for(;x.length*8<p.length;)x.push(0);return p.forEach((C,w)=>x[w>>>3]|=C<<7-(w&7)),new a(u,i,x,d)}size;mask;modules=[];isFunction=[];constructor(t,i,o,c){if(this.version=t,this.errorCorrectionLevel=i,t<a.MIN_VERSION||t>a.MAX_VERSION)throw new RangeError("Version value out of range");if(c<-1||c>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let d=[];for(let u=0;u<this.size;u++)d.push(!1);for(let u=0;u<this.size;u++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();let g=this.addEccAndInterleave(o);if(this.drawCodewords(g),c==-1){let u=1e9;for(let z=0;z<8;z++){this.applyMask(z),this.drawFormatBits(z);let p=this.getPenaltyScore();p<u&&(c=z,u=p),this.applyMask(z)}}n(c>=0&&c<=7),this.mask=c,this.applyMask(c),this.drawFormatBits(c),this.isFunction=[]}getModule(t,i){return t>=0&&t<this.size&&i>=0&&i<this.size&&this.modules[i][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let o=0;o<this.size;o++)this.setFunctionModule(6,o,o%2==0),this.setFunctionModule(o,6,o%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);let t=this.getAlignmentPatternPositions(),i=t.length;for(let o=0;o<i;o++)for(let c=0;c<i;c++)o==0&&c==0||o==0&&c==i-1||o==i-1&&c==0||this.drawAlignmentPattern(t[o],t[c]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){let i=this.errorCorrectionLevel.formatBits<<3|t,o=i;for(let d=0;d<10;d++)o=o<<1^(o>>>9)*1335;let c=(i<<10|o)^21522;n(c>>>15==0);for(let d=0;d<=5;d++)this.setFunctionModule(8,d,s(c,d));this.setFunctionModule(8,7,s(c,6)),this.setFunctionModule(8,8,s(c,7)),this.setFunctionModule(7,8,s(c,8));for(let d=9;d<15;d++)this.setFunctionModule(14-d,8,s(c,d));for(let d=0;d<8;d++)this.setFunctionModule(this.size-1-d,8,s(c,d));for(let d=8;d<15;d++)this.setFunctionModule(8,this.size-15+d,s(c,d));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let o=0;o<12;o++)t=t<<1^(t>>>11)*7973;let i=this.version<<12|t;n(i>>>18==0);for(let o=0;o<18;o++){let c=s(i,o),d=this.size-11+o%3,g=Math.floor(o/3);this.setFunctionModule(d,g,c),this.setFunctionModule(g,d,c)}}drawFinderPattern(t,i){for(let o=-4;o<=4;o++)for(let c=-4;c<=4;c++){let d=Math.max(Math.abs(c),Math.abs(o)),g=t+c,u=i+o;g>=0&&g<this.size&&u>=0&&u<this.size&&this.setFunctionModule(g,u,d!=2&&d!=4)}}drawAlignmentPattern(t,i){for(let o=-2;o<=2;o++)for(let c=-2;c<=2;c++)this.setFunctionModule(t+c,i+o,Math.max(Math.abs(c),Math.abs(o))!=1)}setFunctionModule(t,i,o){this.modules[i][t]=o,this.isFunction[i][t]=!0}addEccAndInterleave(t){let i=this.version,o=this.errorCorrectionLevel;if(t.length!=a.getNumDataCodewords(i,o))throw new RangeError("Invalid argument");let c=a.NUM_ERROR_CORRECTION_BLOCKS[o.ordinal][i],d=a.ECC_CODEWORDS_PER_BLOCK[o.ordinal][i],g=Math.floor(a.getNumRawDataModules(i)/8),u=c-g%c,z=Math.floor(g/c),p=[],P=a.reedSolomonComputeDivisor(d);for(let C=0,w=0;C<c;C++){let F=t.slice(w,w+z-d+(C<u?0:1));w+=F.length;let xt=a.reedSolomonComputeRemainder(F,P);C<u&&F.push(0),p.push(F.concat(xt))}let x=[];for(let C=0;C<p[0].length;C++)p.forEach((w,F)=>{(C!=z-d||F>=u)&&x.push(w[C])});return n(x.length==g),x}drawCodewords(t){if(t.length!=Math.floor(a.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let i=0;for(let o=this.size-1;o>=1;o-=2){o==6&&(o=5);for(let c=0;c<this.size;c++)for(let d=0;d<2;d++){let g=o-d,z=(o+1&2)==0?this.size-1-c:c;!this.isFunction[z][g]&&i<t.length*8&&(this.modules[z][g]=s(t[i>>>3],7-(i&7)),i++)}}n(i==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let i=0;i<this.size;i++)for(let o=0;o<this.size;o++){let c;switch(t){case 0:c=(o+i)%2==0;break;case 1:c=i%2==0;break;case 2:c=o%3==0;break;case 3:c=(o+i)%3==0;break;case 4:c=(Math.floor(o/3)+Math.floor(i/2))%2==0;break;case 5:c=o*i%2+o*i%3==0;break;case 6:c=(o*i%2+o*i%3)%2==0;break;case 7:c=((o+i)%2+o*i%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[i][o]&&c&&(this.modules[i][o]=!this.modules[i][o])}}getPenaltyScore(){let t=0;for(let d=0;d<this.size;d++){let g=!1,u=0,z=[0,0,0,0,0,0,0];for(let p=0;p<this.size;p++)this.modules[d][p]==g?(u++,u==5?t+=a.PENALTY_N1:u>5&&t++):(this.finderPenaltyAddHistory(u,z),g||(t+=this.finderPenaltyCountPatterns(z)*a.PENALTY_N3),g=this.modules[d][p],u=1);t+=this.finderPenaltyTerminateAndCount(g,u,z)*a.PENALTY_N3}for(let d=0;d<this.size;d++){let g=!1,u=0,z=[0,0,0,0,0,0,0];for(let p=0;p<this.size;p++)this.modules[p][d]==g?(u++,u==5?t+=a.PENALTY_N1:u>5&&t++):(this.finderPenaltyAddHistory(u,z),g||(t+=this.finderPenaltyCountPatterns(z)*a.PENALTY_N3),g=this.modules[p][d],u=1);t+=this.finderPenaltyTerminateAndCount(g,u,z)*a.PENALTY_N3}for(let d=0;d<this.size-1;d++)for(let g=0;g<this.size-1;g++){let u=this.modules[d][g];u==this.modules[d][g+1]&&u==this.modules[d+1][g]&&u==this.modules[d+1][g+1]&&(t+=a.PENALTY_N2)}let i=0;for(let d of this.modules)i=d.reduce((g,u)=>g+(u?1:0),i);let o=this.size*this.size,c=Math.ceil(Math.abs(i*20-o*10)/o)-1;return n(c>=0&&c<=9),t+=c*a.PENALTY_N4,n(t>=0&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{let t=Math.floor(this.version/7)+2,i=Math.floor((this.version*8+t*3+5)/(t*4-4))*2,o=[6];for(let c=this.size-7;o.length<t;c-=i)o.splice(1,0,c);return o}}static getNumRawDataModules(t){if(t<a.MIN_VERSION||t>a.MAX_VERSION)throw new RangeError("Version number out of range");let i=(16*t+128)*t+64;if(t>=2){let o=Math.floor(t/7)+2;i-=(25*o-10)*o-55,t>=7&&(i-=36)}return n(i>=208&&i<=29648),i}static getNumDataCodewords(t,i){return Math.floor(a.getNumRawDataModules(t)/8)-a.ECC_CODEWORDS_PER_BLOCK[i.ordinal][t]*a.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let i=[];for(let c=0;c<t-1;c++)i.push(0);i.push(1);let o=1;for(let c=0;c<t;c++){for(let d=0;d<i.length;d++)i[d]=a.reedSolomonMultiply(i[d],o),d+1<i.length&&(i[d]^=i[d+1]);o=a.reedSolomonMultiply(o,2)}return i}static reedSolomonComputeRemainder(t,i){let o=i.map(c=>0);for(let c of t){let d=c^o.shift();o.push(0),i.forEach((g,u)=>o[u]^=a.reedSolomonMultiply(g,d))}return o}static reedSolomonMultiply(t,i){if(t>>>8||i>>>8)throw new RangeError("Byte out of range");let o=0;for(let c=7;c>=0;c--)o=o<<1^(o>>>7)*285,o^=(i>>>c&1)*t;return n(o>>>8==0),o}finderPenaltyCountPatterns(t){let i=t[1];n(i<=this.size*3);let o=i>0&&t[2]==i&&t[3]==i*3&&t[4]==i&&t[5]==i;return(o&&t[0]>=i*4&&t[6]>=i?1:0)+(o&&t[6]>=i*4&&t[0]>=i?1:0)}finderPenaltyTerminateAndCount(t,i,o){return t&&(this.finderPenaltyAddHistory(i,o),i=0),i+=this.size,this.finderPenaltyAddHistory(i,o),this.finderPenaltyCountPatterns(o)}finderPenaltyAddHistory(t,i){i[0]==0&&(t+=this.size),i.pop(),i.unshift(t)}static MIN_VERSION=1;static MAX_VERSION=40;static PENALTY_N1=3;static PENALTY_N2=3;static PENALTY_N3=40;static PENALTY_N4=10;static ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]];static NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]}return a})();r.QrCode=m;function e(a,h,t){if(h<0||h>31||a>>>h)throw new RangeError("Value out of range");for(let i=h-1;i>=0;i--)t.push(a>>>i&1)}function s(a,h){return(a>>>h&1)!=0}function n(a){if(!a)throw new Error("Assertion error")}let l=(()=>{class a{mode;numChars;bitData;static makeBytes(t){let i=[];for(let o of t)e(o,8,i);return new a(a.Mode.BYTE,t.length,i)}static makeNumeric(t){if(!a.isNumeric(t))throw new RangeError("String contains non-numeric characters");let i=[];for(let o=0;o<t.length;){let c=Math.min(t.length-o,3);e(parseInt(t.substring(o,o+c),10),c*3+1,i),o+=c}return new a(a.Mode.NUMERIC,t.length,i)}static makeAlphanumeric(t){if(!a.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let i=[],o;for(o=0;o+2<=t.length;o+=2){let c=a.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o))*45;c+=a.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o+1)),e(c,11,i)}return o<t.length&&e(a.ALPHANUMERIC_CHARSET.indexOf(t.charAt(o)),6,i),new a(a.Mode.ALPHANUMERIC,t.length,i)}static makeSegments(t){return t==""?[]:a.isNumeric(t)?[a.makeNumeric(t)]:a.isAlphanumeric(t)?[a.makeAlphanumeric(t)]:[a.makeBytes(a.toUtf8ByteArray(t))]}static makeEci(t){let i=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)e(t,8,i);else if(t<16384)e(2,2,i),e(t,14,i);else if(t<1e6)e(6,3,i),e(t,21,i);else throw new RangeError("ECI assignment value out of range");return new a(a.Mode.ECI,0,i)}static isNumeric(t){return a.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return a.ALPHANUMERIC_REGEX.test(t)}constructor(t,i,o){if(this.mode=t,this.numChars=i,this.bitData=o,i<0)throw new RangeError("Invalid argument");this.bitData=o.slice()}getData(){return this.bitData.slice()}static getTotalBits(t,i){let o=0;for(let c of t){let d=c.mode.numCharCountBits(i);if(c.numChars>=1<<d)return 1/0;o+=4+d+c.bitData.length}return o}static toUtf8ByteArray(t){t=encodeURI(t);let i=[];for(let o=0;o<t.length;o++)t.charAt(o)!="%"?i.push(t.charCodeAt(o)):(i.push(parseInt(t.substring(o+1,o+3),16)),o+=2);return i}static NUMERIC_REGEX=/^[0-9]*$/;static ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+./:-]*$/;static ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:"}return a})();r.QrSegment=l})(k||(k={}));(function(r){let m;(function(e){class s{ordinal;formatBits;static LOW=new s(0,1);static MEDIUM=new s(1,0);static QUARTILE=new s(2,3);static HIGH=new s(3,2);constructor(l,a){this.ordinal=l,this.formatBits=a}}e.Ecc=s})(m=r.QrCode||(r.QrCode={}))})(k||(k={}));(function(r){let m;(function(e){class s{modeBits;numBitsCharCount;static NUMERIC=new s(1,[10,12,14]);static ALPHANUMERIC=new s(2,[9,11,13]);static BYTE=new s(4,[8,16,16]);static KANJI=new s(8,[8,10,12]);static ECI=new s(7,[0,0,0]);constructor(l,a){this.modeBits=l,this.numBitsCharCount=a}numCharCountBits(l){return this.numBitsCharCount[Math.floor((l+7)/17)]}}e.Mode=s})(m=r.QrSegment||(r.QrSegment={}))})(k||(k={}));var be=k,re=be.QrCode.Ecc,hn={L:re.LOW,M:re.MEDIUM,Q:re.QUARTILE,H:re.HIGH},Dt="M",Se="#FFFFFF",Ne="#000000",gn=1,fn=.1,Rt=(r,m=0)=>{let e=[];return r.forEach((s,n)=>{let l=null;s.forEach((a,h)=>{if(!a&&l!==null){e.push(`M${l+m} ${n+m}h${h-l}v1H${l+m}z`),l=null;return}if(h===s.length-1){if(!a)return;l===null?e.push(`M${h+m},${n+m} h1v1H${h+m}z`):e.push(`M${l+m},${n+m} h${h+1-l}v1H${l+m}z`);return}a&&l===null&&(l=h)})}),e.join("")},Tt=(r,m)=>r.slice().map((e,s)=>s<m.y||s>=m.y+m.h?e:e.map((n,l)=>l<m.x||l>=m.x+m.w?n:!1)),pn=(r,m,e,s)=>{if(s==null)return null;let n=r.length+e*2,l=Math.floor(m*fn),a=n/m,h=(s.width||l)*a,t=(s.height||l)*a,i=s.x==null?r.length/2-h/2:s.x*a,o=s.y==null?r.length/2-t/2:s.y*a,c=s.opacity==null?1:s.opacity,d=null;if(s.excavate){let u=Math.floor(i),z=Math.floor(o),p=Math.ceil(h+i-u),P=Math.ceil(t+o-z);d={x:u,y:z,w:p,h:P}}let g=s.crossOrigin;return{x:i,y:o,h:t,w:h,excavation:d,opacity:c,crossOrigin:g}},zn=r=>Math.max(Math.floor(r),0),Cn=(()=>{try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),vn=(()=>{class r{canvas=X.required("canvas");image=X("image");icon=f("");margin=f(0);cells=f([]);numCells=f(0);calculatedImageSettings=f(null);size=f(160);color=f(Ne);bgColor=f(Se);constructor(){$(()=>{this.icon(),this.margin(),this.cells(),this.numCells(),this.calculatedImageSettings(),this.size(),this.color(),this.bgColor(),this.canvas()?.nativeElement&&this.render()})}ngAfterViewInit(){this.render()}render(){let e=this.canvas();if(!e)return;let s=e.nativeElement.getContext("2d");s&&(this.setupCanvas(s),this.drawQRCode(s),this.handleImageLoading(s))}setupCanvas(e){let s=this.canvas();if(!s)return;let n=window.devicePixelRatio||1;s.nativeElement.height=s.nativeElement.width=this.size()*n,s.nativeElement.style.width=s.nativeElement.style.height=`${this.size()}px`;let l=this.size()/this.numCells()*n;e.scale(l,l),e.fillStyle=this.bgColor(),e.fillRect(0,0,this.numCells(),this.numCells()),e.fillStyle=this.color()}drawQRCode(e){let s=this.getCellsToDraw();this.haveImageToRender()||this.renderQRCode(e,s)}getCellsToDraw(){let e=this.cells(),s=this.calculatedImageSettings();return this.haveImageToRender()&&s&&s.excavation&&(e=Tt(this.cells(),s.excavation)),e}haveImageToRender(){return this.calculatedImageSettings()!=null&&!!this.image()}renderQRCode(e,s){Cn?e.fill(new Path2D(Rt(s,this.margin()))):s.forEach((n,l)=>{n.forEach((a,h)=>{a&&e.fillRect(h+this.margin(),l+this.margin(),1,1)})})}handleImageLoading(e){if(!this.haveImageToRender())return;let s=this.image();if(!s)return;let n=()=>{this.cleanupImageListeners(n,l),this.onImageLoadSuccess(e)},l=()=>{this.cleanupImageListeners(n,l),this.onImageLoadError(e)};s.nativeElement.addEventListener("load",n),s.nativeElement.addEventListener("error",l)}onImageLoadSuccess(e){let s=this.getCellsToDraw();this.renderQRCode(e,s);let n=this.calculatedImageSettings(),l=this.image();n&&l&&(e.globalAlpha=n.opacity,e.drawImage(l.nativeElement,n.x+this.margin(),n.y+this.margin(),n.w,n.h))}onImageLoadError(e){let s=this.getCellsToDraw();this.renderQRCode(e,s)}cleanupImageListeners(e,s){let n=this.image();n?.nativeElement&&(n.nativeElement.removeEventListener("load",e),n.nativeElement.removeEventListener("error",s))}static \u0275fac=function(s){return new(s||r)};static \u0275cmp=T({type:r,selectors:[["nz-qrcode-canvas"]],viewQuery:function(s,n){s&1&&G(n.canvas,Zt,5)(n.image,Jt,5),s&2&&W(2)},inputs:{icon:[1,"icon"],margin:[1,"margin"],cells:[1,"cells"],numCells:[1,"numCells"],calculatedImageSettings:[1,"calculatedImageSettings"],size:[1,"size"],color:[1,"color"],bgColor:[1,"bgColor"]},exportAs:["nzQRCodeCanvas"],decls:3,vars:1,consts:[["canvas",""],["image",""],["role","img"],["alt","QR-Code","crossorigin","anonymous",2,"display","none"]],template:function(s,n){s&1&&(Y(0,"canvas",2,0),E(2,en,2,1,"img",3)),s&2&&(v(2),I(n.icon()?2:-1))},styles:["[_nghost-%COMP%]{display:block;line-height:0}"],changeDetection:0})}return r})(),bn=be.QrSegment,Sn=(r,m=Dt,e,s,n,l,a)=>{let h=Nn(r,m,e,n),t=zn(l),i=h.getModules().length+t*2,o=pn(h.getModules(),s,t,a);return{cells:h.getModules(),margin:t,numCells:i,calculatedImageSettings:o,qrcode:h}},Nn=(r,m=Dt,e,s)=>{let l=(Array.isArray(r)?r:[r]).reduce((a,h)=>(a.push(...bn.makeSegments(h)),a),[]);return be.QrCode.encodeSegments(l,hn[m],e,void 0,void 0,s)},wn=(()=>{class r{icon=f("");color=f(Ne);bgColor=f(Se);imageSettings=f();size=f(160);margin=f(0);calculatedImageSettings=f(null);cells=f([]);numCells=f(0);viewBox="";backgroundPath="";foregroundPath="";constructor(){$(()=>{this.initializeViewBox(),this.generatePaths()})}initializeViewBox(){this.viewBox=`0 0 ${this.numCells()} ${this.numCells()}`,this.backgroundPath=`M0,0 h${this.numCells()}v${this.numCells()}H0z`}generatePaths(){let e=this.getCellsToDraw();this.foregroundPath=Rt(e,this.margin())}getCellsToDraw(){return this.shouldExcavateCells()?Tt(this.cells(),this.calculatedImageSettings().excavation):this.cells()}shouldExcavateCells(){let e=this.calculatedImageSettings();return e!==null&&!!this.icon()&&e.excavation!==null}shouldShowIcon(){return!!this.icon()&&this.calculatedImageSettings()!=null}getImageX(){return(this.calculatedImageSettings()?.x||0)+this.margin()}getImageY(){return(this.calculatedImageSettings()?.y||0)+this.margin()}static \u0275fac=function(s){return new(s||r)};static \u0275cmp=T({type:r,selectors:[["nz-qrcode-svg"]],inputs:{icon:[1,"icon"],color:[1,"color"],bgColor:[1,"bgColor"],imageSettings:[1,"imageSettings"],size:[1,"size"],margin:[1,"margin"],calculatedImageSettings:[1,"calculatedImageSettings"],cells:[1,"cells"],numCells:[1,"numCells"]},exportAs:["nzQRCodeSVG"],decls:4,vars:8,consts:[["role","img"],["shapeRendering","crispEdges"],["preserveAspectRatio","none"]],template:function(s,n){s&1&&(me(),We(0,"svg",0),Y(1,"path",1)(2,"path",1),E(3,tn,1,7,":svg:image",2),He()),s&2&&(y("height",n.size())("width",n.size())("viewBox",n.viewBox),v(),y("fill",n.bgColor())("d",n.backgroundPath),v(),y("fill",n.color())("d",n.foregroundPath),v(),I(n.shouldShowIcon()?3:-1))},styles:["[_nghost-%COMP%]{display:block;line-height:0}"],changeDetection:0})}return r})(),Mn=(()=>{class r{i18n=_(ht);locale=J(this.i18n.localeChange.pipe(ie(()=>this.i18n.getLocaleData("QRCode"))),{requireSync:!0});isBrowser=ot(_(Be));nzValue=f("");nzType=f("canvas");nzColor=f(Ne);nzBgColor=f(Se);nzSize=f(160);nzIcon=f("");nzIconSize=f(40);nzBordered=f(!0);nzStatus=f("active");nzLevel=f("M");nzStatusRender=f(null);nzBoostLevel=f(!0);nzPadding=f(0);nzRefresh=et();margin=R(0);cells=R([]);numCells=R(0);calculatedImageSettings=R(null);imageSettings=B(()=>({src:this.nzIcon(),x:void 0,y:void 0,height:this.nzIconSize()??40,width:this.nzIconSize()??40,excavate:!0,crossOrigin:"anonymous"}));constructor(){$(()=>{this.updateQRCodeData()})}reloadQRCode(){this.updateQRCodeData(),this.nzRefresh.emit("refresh")}updateQRCodeData(){let{margin:e,cells:s,numCells:n,calculatedImageSettings:l}=Sn(this.nzValue(),this.nzLevel(),gn,this.nzSize(),this.nzBoostLevel(),this.nzPadding(),this.imageSettings());this.margin.set(e),this.cells.set(s),this.numCells.set(n),this.calculatedImageSettings.set(l)}static \u0275fac=function(s){return new(s||r)};static \u0275cmp=T({type:r,selectors:[["nz-qrcode"]],hostAttrs:[1,"ant-qrcode"],hostVars:4,hostBindings:function(s,n){s&2&&(Ge("background-color",n.nzBgColor()),K("ant-qrcode-border",n.nzBordered()))},inputs:{nzValue:[1,"nzValue"],nzType:[1,"nzType"],nzColor:[1,"nzColor"],nzBgColor:[1,"nzBgColor"],nzSize:[1,"nzSize"],nzIcon:[1,"nzIcon"],nzIconSize:[1,"nzIconSize"],nzBordered:[1,"nzBordered"],nzStatus:[1,"nzStatus"],nzLevel:[1,"nzLevel"],nzStatusRender:[1,"nzStatusRender"],nzBoostLevel:[1,"nzBoostLevel"],nzPadding:[1,"nzPadding"]},outputs:{nzRefresh:"nzRefresh"},exportAs:["nzQRCode"],decls:3,vars:2,consts:[[1,"ant-qrcode-mask"],[4,"nzStringTemplateOutlet"],[1,"ant-qrcode-expired"],["nz-button","","nzType","link",3,"click"],["nzType","reload","nzTheme","outline"],[3,"icon","margin","cells","numCells","calculatedImageSettings","size","color","bgColor"],[3,"color","bgColor","icon","margin","cells","numCells","imageSettings","calculatedImageSettings","size"]],template:function(s,n){s&1&&(E(0,sn,2,1,"div",0)(1,cn,4,1,"div",0),E(2,un,2,1)),s&2&&(I(n.nzStatusRender()?0:n.nzStatus()!=="active"?1:-1),v(2),I(n.isBrowser?2:-1))},dependencies:[Nt,St,ut,mt,dt,ee,se,lt,wn,vn],encapsulation:2,changeDetection:0})}return r})(),yi=(()=>{class r{static \u0275fac=function(s){return new(s||r)};static \u0275mod=ge({type:r});static \u0275inj=de({imports:[Mn]})}return r})();export{Mn as a,yi as b,j as c,li as d};
