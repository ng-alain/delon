import{a as P}from"./chunk-FBMV6BKX.js";import{a as T,b as L}from"./chunk-U2X7MARR.js";import{C as v,Gc as j,H as c,Id as I,Jb as A,Jd as R,Kb as D,L as g,La as l,Lb as $,Ld as f,Qb as d,Rd as M,Ub as o,Va as x,Vc as k,Wa as S,a as u,ba as E,ca as _,fa as r,g as C,k as y,kb as N,mb as z,qa as b,ra as O,sa as w,ub as p}from"./chunk-6YVQZL4D.js";var a=class n{cogSrv=r(R);lazySrv=r(I);_cog;loading=!1;loaded=!1;notify$=new y;get cog(){return this._cog}set cog(t){this._cog=this.cogSrv.merge("chart",{theme:"",echartsLib:"https://cdnjs.cloudflare.com/ajax/libs/echarts/5.1.0/echarts.min.js"},t)}constructor(){this.cog={theme:""}}libLoad(){return this.loading?(this.loaded&&this.notify$.next(),this):(this.loading=!0,this.lazySrv.load(this.cog.echartsLib).then(()=>{let t=this.cog.echartsExtensions;return Array.isArray(t)&&t.length>0?this.lazySrv.load(t).then(()=>!0):Promise.resolve(!0)}).then(()=>{this.loaded=!0,this.notify$.next()}),this)}get notify(){return this.notify$.asObservable()}ngOnDestroy(){this.notify$.unsubscribe()}static \u0275fac=function(e){return new(e||n)};static \u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})};var q=["container"];function B(n,t){n&1&&(o(0,`
      `),p(1,"nz-skeleton"),o(2,`
    `))}var s=class s{srv=r(a);cdr=r(j);ngZone=r(w);platform=r(M);node;destroy$=r(b);_chart=null;_theme;_initOpt;_option;_width="100%";_height="400px";set width(t){this._width=typeof t=="number"?`${t}px`:`${t}`}set height(t){this._height=typeof t=="number"?`${t}px`:`${t}`}set theme(t){this._theme=t,this._chart&&this.install()}set initOpt(t){this._initOpt=t,this._chart&&this.install()}set option(t){this._option=t,this._chart&&this.setOption(t,!0)}on=[];events=new O;get chart(){return this._chart}loaded=!1;constructor(){this.srv.notify.pipe(f(),c(()=>!this.loaded)).subscribe(()=>this.load()),this.theme=this.srv.cog.echartsTheme}emit(t,e){this.events.emit(u({type:t,chart:this.chart},e))}load(){this.ngZone.run(()=>{this.loaded=!0,this.cdr.detectChanges()}),this.emit("ready"),this.install()}install(){this.destroy();let t=this._chart=window.echarts.init(this.node.nativeElement,this._theme,this._initOpt);return this.emit("init"),this.setOption(this._option),this.on.forEach(e=>{e.query!=null?t.on(e.eventName,e.query,i=>e.handler({event:i,chart:t})):t.on(e.eventName,i=>e.handler({event:i,chart:t}))}),this}destroy(){return this._chart&&(this._chart.dispose(),this.emit("destroy")),this}setOption(t,e=!1,i=!1){return this._chart&&(this._chart.setOption(t,e,i),this.emit("set-option",{option:t})),this}ngOnInit(){this.platform.isBrowser&&(window.echarts?this.load():this.srv.libLoad(),v(window,"resize").pipe(f(this.destroy$),c(()=>!!this._chart),g(200)).subscribe(()=>this._chart.resize()))}ngOnDestroy(){this.on.forEach(t=>this._chart?.off(t.eventName)),this.destroy()}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=x({type:s,selectors:[["chart-echarts"],["","chart-echarts",""]],viewQuery:function(e,i){if(e&1&&A(q,7),e&2){let m;D(m=$())&&(i.node=m.first)}},hostVars:6,hostBindings:function(e,i){e&2&&d("display","inline-block")("width",i._width)("height",i._height)},inputs:{width:"width",height:"height",theme:"theme",initOpt:"initOpt",option:"option",on:"on"},outputs:{events:"events"},exportAs:["chartECharts"],decls:5,vars:5,consts:[["container",""]],template:function(e,i){e&1&&(o(0,`
    `),N(1,B,3,0),p(2,"div",null,0),o(4,`
  `)),e&2&&(l(),z(i.loaded?-1:1),l(),d("width",i._width)("height",i._height))},dependencies:[T],encapsulation:2,changeDetection:0})};C([P()],s.prototype,"load",1);var h=s;var F=[h],Z=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=S({type:n});static \u0275inj=_({imports:[k,L,F]})};export{h as a,Z as b};
