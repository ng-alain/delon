import{a as S}from"./chunk-BAPU3RXT.js";import{a as st,b as lt}from"./chunk-J6XY7ONC.js";import{Aa as M,Ab as q,Bb as J,C as D,Db as K,Eb as X,H as c,Ja as C,L as z,Lb as Y,Qa as A,Ra as m,Sa as L,Va as N,Wa as Z,X as p,a as _,ba as T,ca as k,cb as H,cc as tt,dc as u,ec as f,fa as a,ha as E,hb as R,ia as G,ib as Q,ig as rt,ja as B,jb as w,jg as at,k as h,kb as P,kd as it,lb as V,ld as nt,pa as $,q as v,sb as W,sd as ot,ua as j,xa as d,ya as F,yc as et,zb as U}from"./chunk-PQ76J5IX.js";var ht=(()=>{class e{get cog(){return this._cog}set cog(t){this._cog=this.cogSrv.merge("chart",{theme:"",libs:["https://gw.alipayobjects.com/os/lib/antv/g2/4.1.46/dist/g2.min.js","https://gw.alipayobjects.com/os/lib/antv/data-set/0.11.8/dist/data-set.js"]},t)}constructor(){this.cogSrv=a(nt),this.lazySrv=a(it),this.loading=!1,this.loaded=!1,this.notify$=new h,this.cog={theme:""}}libLoad(){return this.loading?(this.loaded&&this.notify$.next(),this):(this.loading=!0,this.lazySrv.load(this.cog.libs).then(()=>{this.loaded=!0,this.notify$.next()}),this)}get notify(){return this.notify$.asObservable()}ngOnDestroy(){this.notify$.unsubscribe()}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275prov=T({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var pt=["container"],l=class e{get chart(){return this._chart}get winG2(){return window.G2}constructor(){this.srv=a(ht),this.el=a(M),this.ngZone=a(F),this.platform=a(ot),this.cdr=a(tt),this.repaint=!0,this.destroy$=new h,this.loaded=!1,this.delay=0,this.ready=new d,this.theme=this.srv.cog.theme,this.srv.notify.pipe(p(this.destroy$),c(()=>!this.loaded)).subscribe(()=>this.load())}changeData(){}onInit(){}onChanges(o){}load(){this.ngZone.run(()=>{this.loaded=!0,this.cdr.detectChanges()}),setTimeout(()=>this.install(),this.delay)}ngOnInit(){this.platform.isBrowser&&(this.onInit(),this.winG2?this.load():this.srv.libLoad())}ngOnChanges(o){if(this.onChanges(o),this.onlyChangeData?this.onlyChangeData(o):Object.keys(o).length===1&&!!o.data){this.changeData();return}!this.chart||!this.repaint||this.ngZone.runOutsideAngular(()=>{this.destroyChart().install()})}destroyChart(){return this._chart&&this._chart.destroy(),this}ngOnDestroy(){this.resize$&&this.resize$.unsubscribe(),this.destroy$.next(),this.destroy$.complete(),this.destroyChart()}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275dir=B({type:e,viewQuery:function(t,i){if(t&1&&U(pt,7),t&2){let n;q(n=J())&&(i.node=n.first)}},inputs:{repaint:[2,"repaint","repaint",u],delay:[2,"delay","delay",f],theme:"theme"},outputs:{ready:"ready"},features:[m,$]})}};v([S()],l.prototype,"load",null);v([S()],l.prototype,"destroyChart",null);function Bt(e,o){let t=_({showTitle:!1,showMarkers:!0,enterable:!0,domStyles:{"g2-tooltip":{padding:"0px"},"g2-tooltip-title":{display:"none"},"g2-tooltip-list-item":{margin:"4px"}}},o);return e==="mini"&&(t.position="top",t.domStyles["g2-tooltip"]={padding:"0px",backgroundColor:"transparent",boxShadow:"none"},t.itemTpl="<li>{value}</li>",t.offset=8),t}function dt(e,o){if(e&1&&(P(0),R(1,"h4",2),K(2),Q(),V()),e&2){let t=W();C(2),X(t.title)}}function mt(e,o){e&1&&w(0,"nz-skeleton")}var ut=41,ct=(()=>{class e extends l{constructor(){super(...arguments),this.color="rgba(24, 144, 255, 0.85)",this.height=0,this.padding="auto",this.data=[],this.autoLabel=!0,this.interaction="none",this.clickItem=new d}getHeight(){return this.title?this.height-ut:this.height}install(){let{node:t,padding:i,interaction:n,theme:g}=this,y=t.nativeElement,r=this._chart=new this.winG2.Chart({container:y,autoFit:!0,height:this.getHeight(),padding:i,theme:g});this.updatelabel(),r.axis("y",{title:null,line:null,tickLine:null}),r.scale({x:{type:"cat"},y:{min:0}}),r.tooltip({showTitle:!1}),n!=="none"&&r.interaction(n),r.legend(!1),r.interval().position("x*y").color("x*y",(s,b)=>{let x=this.data.find(O=>O.x===s&&O.y===b);return x&&x.color?x.color:this.color}).tooltip("x*y",(s,b)=>({name:s,value:b})),r.on("interval:click",s=>{this.ngZone.run(()=>this.clickItem.emit({item:s.data?.data,ev:s}))}),this.ready.next(r),this.changeData(),r.render(),this.installResizeEvent()}changeData(){let{_chart:t,data:i}=this;!t||!Array.isArray(i)||i.length<=0||t.changeData(i)}updatelabel(){let{node:t,data:i,_chart:n}=this,g=t.nativeElement.clientWidth,y=i.length*30;n.axis("x",g>y).render()}installResizeEvent(){!this.autoLabel||this.resize$||(this.resize$=D(window,"resize").pipe(p(this.destroy$),c(()=>!!this._chart),z(200)).subscribe(()=>this.ngZone.runOutsideAngular(()=>this.updatelabel())))}static{this.\u0275fac=(()=>{let t;return function(n){return(t||(t=j(e)))(n||e)}})()}static{this.\u0275cmp=E({type:e,selectors:[["g2-bar"]],hostVars:2,hostBindings:function(i,n){i&2&&Z("height",n.height,"px")},inputs:{title:"title",color:"color",height:[2,"height","height",f],padding:"padding",data:"data",autoLabel:[2,"autoLabel","autoLabel",u],interaction:"interaction"},outputs:{clickItem:"clickItem"},exportAs:["g2Bar"],standalone:!0,features:[m,A,Y],decls:4,vars:2,consts:[["container",""],[4,"nzStringTemplateOutlet"],[2,"margin-bottom","20px"]],template:function(i,n){i&1&&(L(0,dt,3,1,"ng-container",1)(1,mt,1,0,"nz-skeleton"),w(2,"div",null,0)),i&2&&(N("nzStringTemplateOutlet",n.title),C(),H(n.loaded?-1:1))},dependencies:[rt,st],encapsulation:2,changeDetection:0})}}return e})();var ft=[ct],re=(()=>{class e{static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275mod=G({type:e})}static{this.\u0275inj=k({imports:[et,at,lt,ft]})}}return e})();export{l as a,Bt as b,ct as c,re as d};
