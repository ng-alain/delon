import{a as R}from"./chunk-VSIMNQ2S.js";import{a as M,b as P}from"./chunk-YZR7MD3I.js";import{Ad as j,Bd as k,Dd as l,E as C,J as h,Jd as T,Ma as O,Nc as $,O as y,Ob as A,Pb as x,Qb as I,Za as w,_a as N,a as d,ca as g,da as v,db as S,g as f,ga as r,jb as c,l as u,rb as z,sa as E,tc as D,ua as _,va as b,yb as p}from"./chunk-SCDKUK6D.js";var s=class n{cogSrv=r(k);lazySrv=r(j);_cog;loading=!1;loaded=!1;notify$=new u;get cog(){return this._cog}set cog(t){this._cog=this.cogSrv.merge("chart",{theme:"",echartsLib:"https://cdnjs.cloudflare.com/ajax/libs/echarts/5.1.0/echarts.min.js"},t)}constructor(){this.cog={theme:""}}libLoad(){return this.loading?(this.loaded&&this.notify$.next(),this):(this.loading=!0,this.lazySrv.load(this.cog.echartsLib).then(()=>{let t=this.cog.echartsExtensions;return Array.isArray(t)&&t.length>0?this.lazySrv.load(t).then(()=>!0):Promise.resolve(!0)}).then(()=>{this.loaded=!0,this.notify$.next()}),this)}get notify(){return this.notify$.asObservable()}ngOnDestroy(){this.notify$.unsubscribe()}static \u0275fac=function(e){return new(e||n)};static \u0275prov=g({token:n,factory:n.\u0275fac,providedIn:"root"})};var Z=["container"];function q(n,t){n&1&&p(0,"nz-skeleton")}var o=class o{static ngAcceptInputType_width;static ngAcceptInputType_height;srv=r(s);cdr=r(D);ngZone=r(b);platform=r(T);node;destroy$=r(E);_chart=null;_theme;_initOpt;_option;_width="100%";_height="400px";set width(t){this._width=typeof t=="number"?`${t}px`:`${t}`}set height(t){this._height=typeof t=="number"?`${t}px`:`${t}`}set theme(t){this._theme=t,this._chart&&this.install()}set initOpt(t){this._initOpt=t,this._chart&&this.install()}set option(t){this._option=t,this._chart&&this.setOption(t,!0)}on=[];events=new _;get chart(){return this._chart}loaded=!1;constructor(){this.srv.notify.pipe(l(),h(()=>!this.loaded)).subscribe(()=>this.load()),this.theme=this.srv.cog.echartsTheme}emit(t,e){this.events.emit(d({type:t,chart:this.chart},e))}load(){this.ngZone.run(()=>{this.loaded=!0,this.cdr.detectChanges()}),this.emit("ready"),this.install()}install(){this.destroy();let t=this._chart=window.echarts.init(this.node.nativeElement,this._theme,this._initOpt);return this.emit("init"),this.setOption(this._option),this.on.forEach(e=>{e.query!=null?t.on(e.eventName,e.query,i=>e.handler({event:i,chart:t})):t.on(e.eventName,i=>e.handler({event:i,chart:t}))}),this}destroy(){return this._chart&&(this._chart.dispose(),this.emit("destroy")),this}setOption(t,e=!1,i=!1){return this._chart&&(this._chart.setOption(t,e,i),this.emit("set-option",{option:t})),this}ngOnInit(){this.platform.isBrowser&&(window.echarts?this.load():this.srv.libLoad(),C(window,"resize").pipe(l(this.destroy$),h(()=>!!this._chart),y(200)).subscribe(()=>this._chart.resize()))}ngOnDestroy(){this.on.forEach(t=>this._chart?.off(t.eventName)),this.destroy()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=w({type:o,selectors:[["chart-echarts"],["","chart-echarts",""]],viewQuery:function(e,i){if(e&1&&A(Z,7),e&2){let m;x(m=I())&&(i.node=m.first)}},hostVars:6,hostBindings:function(e,i){e&2&&c("display","inline-block")("width",i._width)("height",i._height)},inputs:{width:"width",height:"height",theme:"theme",initOpt:"initOpt",option:"option",on:"on"},outputs:{events:"events"},exportAs:["chartECharts"],decls:3,vars:5,consts:[["container",""]],template:function(e,i){e&1&&(S(0,q,1,0,"nz-skeleton"),p(1,"div",null,0)),e&2&&(z(i.loaded?-1:0),O(),c("width",i._width)("height",i._height))},dependencies:[M],encapsulation:2,changeDetection:0})};f([R()],o.prototype,"load",1);var a=o;var B=[a],Q=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=N({type:n});static \u0275inj=v({imports:[$,P,B]})};export{a,Q as b};
